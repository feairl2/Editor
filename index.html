<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>Pro Editor - Refined Glow</title>

<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>

<style>
html, body {
    margin: 0;
    height: 100%;
    background: #101010;
    font-family: -apple-system, "Segoe UI", sans-serif;
    overflow: hidden;
}

/* ===== Tabs ===== */
#tabs-container {
    display: flex;
    align-items: center;
    height: 44px;
    background: #101010;
    padding: 0 12px;
}

#tabs { display: flex; gap: 6px; }

.tab {
    display: flex;
    align-items: center;
    height: 32px;
    padding: 0 12px;
    color: #777;
    cursor: pointer;
    font-size: 13px;
    border-radius: 6px;
    transition: all 0.2s;
}

.tab.active {
    background: #2a2a2a;
    color: #ffd700;
    border: 1px solid rgba(255,215,0,.6);
    box-shadow: 0 0 8px rgba(255,215,0,.12);
}

.close { margin-left: 6px; opacity: .6; }
.close:hover { color:#ff5f56; }

/* ===== Layout ===== */
#layout {
    height: calc(100% - 44px);
    display: flex;
    flex-direction: column;
}

#editor {
    flex: 1;
}

/* ===== Drag Bar ===== */
#console-drag {
    height: 6px;
    cursor: ns-resize;
    background: linear-gradient(to bottom, #101010, #161616);
}

/* ===== Console ===== */
#console {
    height: 160px;
    background: #0d0d0d;
    border-top: 1px solid #222;
    display: flex;
    flex-direction: column;
    font-family: Consolas, monospace;
    transition: height .25s ease;
}

#console.hidden {
    height: 0;
    border-top: none;
}

#console-header {
    height: 28px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    color: #aaa;
    background: #111;
    font-size: 12px;
}

#console-toggle {
    margin-left: auto;
    cursor: pointer;
    opacity: .6;
}
#console-toggle:hover { opacity: 1; }

#console-body {
    flex: 1;
    padding: 8px;
    overflow-y: auto;
    font-size: 12px;
}

.log { margin-bottom: 4px; }
.log.success { color:#00ff88 }
.log.error { color:#ff5555 }
.log.inject { color:#4aa3ff }
.log.info { color:#aaa }
</style>
</head>

<body>

<div id="tabs-container">
    <div id="tabs"></div>
</div>

<div id="layout">
    <div id="editor"></div>
    <div id="console-drag"></div>
    <div id="console">
        <div id="console-header">
            Console
            <span id="console-toggle">▾</span>
        </div>
        <div id="console-body"></div>
    </div>
</div>

<script>
require.config({ paths:{ vs:'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' } });

require(['vs/editor/editor.main'], () => {

monaco.editor.defineTheme('custom-dark', {
    base:'vs-dark',
    inherit:true,
    colors:{
        'editor.background':'#101010',
        'editorCursor.foreground':'#ffd700'
    }
});

window.editor = monaco.editor.create(document.getElementById('editor'), {
    value:'print("Feairl Injected")',
    language:'lua',
    theme:'custom-dark',
    fontSize:14,
    minimap:{enabled:false},
    automaticLayout:true
});

/* ===== Console API ===== */
window.addLog = function(type, msg){
    const div = document.createElement('div');
    const t = new Date().toLocaleTimeString();
    div.className = 'log ' + type;
    div.textContent = `[${t}] ${msg}`;
    document.getElementById('console-body').prepend(div);
}

/* ===== WebView2 接口 ===== */
if (window.chrome?.webview) {
    chrome.webview.addEventListener('message', e => {
        addLog(e.data.type, e.data.message);
    });
}

/* ===== Toggle ===== */
const consoleEl = document.getElementById('console');
document.getElementById('console-toggle').onclick = () => {
    consoleEl.classList.toggle('hidden');
};

/* ===== Drag resize ===== */
let dragging = false;
document.getElementById('console-drag').onmousedown = () => dragging = true;
window.onmouseup = () => dragging = false;
window.onmousemove = e => {
    if (!dragging) return;
    const h = window.innerHeight - e.clientY;
    consoleEl.style.height = Math.max(80, h) + 'px';
};

});
</script>
</body>
</html>
