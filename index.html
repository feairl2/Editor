<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <style>
        html, body {
            margin: 0; padding: 0; height: 100%;
            background: #101010;
            font-family: "Segoe UI", sans-serif;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* 編輯器區域 */
        #editor { flex: 1; width: 100%; background: #101010; }

        /* Console 區域：預設隱藏，由 WinForm 控制 */
        #console-wrapper {
            height: 130px;
            background: #101010;
            padding: 0 12px 12px 12px;
            box-sizing: border-box;
            flex-shrink: 0;
            display: none; /* 初始隱藏 */
        }

        #console-panel {
            background-color: #1a1a1a;
            height: 100%; width: 100%;
            border: 1px solid #282828;
            border-radius: 10px;
            display: flex; flex-direction: column;
            overflow: hidden;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.3);
        }

        #console-header {
            background: #222; padding: 6px 12px;
            font-size: 11px; color: #555; letter-spacing: 1px;
            border-bottom: 1px solid #282828;
        }

        #log-display {
            flex: 1; padding: 10px; overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px; color: #ccc;
        }

        .log-line { margin-bottom: 4px; animation: slideIn 0.2s ease; }
        .log-success { color: #ffd700; }
        .log-error { color: #ff5f56; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; } }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
</head>
<body>
    <div id="editor"></div>
    <div id="console-wrapper">
        <div id="console-panel">
            <div id="console-header">OUTPUT</div>
            <div id="log-display"></div>
        </div>
    </div>

    <script>
        require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' }});
        require(['vs/editor/editor.main'], () => {
            window.editor = monaco.editor.create(document.getElementById('editor'), {
                value: '-- Feairl Team\nprint("Hello")',
                language: 'lua',
                theme: 'vs-dark',
                automaticLayout: true,
                backgroundColor: '#101010'
            });

            // 如果 WinForm 預先注入了初始狀態，立即套用
            if (typeof window.initialVisible !== 'undefined') {
                updateConsoleDisplay(window.initialVisible);
            }
        });

        function updateConsoleDisplay(visible) {
            const wrapper = document.getElementById('console-wrapper');
            wrapper.style.display = visible ? 'block' : 'none';
            if (window.editor) window.editor.layout();
        }

        function appendLog(msg, type) {
            const div = document.createElement('div');
            div.className = `log-line log-${type}`;
            div.innerText = `> ${msg}`;
            const display = document.getElementById('log-display');
            display.appendChild(div);
            display.scrollTop = display.scrollHeight;
        }
    </script>
</body>
</html>
